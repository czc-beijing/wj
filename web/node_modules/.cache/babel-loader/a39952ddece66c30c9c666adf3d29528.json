{"ast":null,"code":"import { ElMessage } from 'element-plus';\nimport { User, Lock, CircleCheck } from '@element-plus/icons-vue';\nexport default {\n  name: \"Login\",\n  setup() {\n    return {\n      User,\n      Lock,\n      CircleCheck\n    };\n  },\n  data() {\n    return {\n      show: true,\n      loginForm: {\n        username: 'admin',\n        password: '12345',\n        captchaId: '',\n        captchaValue: ''\n      },\n      captchaImg: null,\n      rules: {\n        username: [{\n          equired: true,\n          message: '请输入账号',\n          trigger: 'blur'\n        }],\n        password: [{\n          equired: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }],\n        captchaValue: [{\n          required: true,\n          message: '请输入验证码',\n          trigger: 'blur'\n        }, {\n          min: 4,\n          max: 4,\n          message: '长度为 4 个字符',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  mounted() {\n    this.getCaptcha();\n  },\n  updated() {\n    this.getCaptcha();\n  },\n  methods: {\n    // 用户登录\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          this.$axios.post('/login', {\n            username: this.loginForm.username,\n            password: this.loginForm.password,\n            captchaId: this.loginForm.captchaId,\n            captchaValue: this.loginForm.captchaValue\n          }).then(response => {\n            localStorage.setItem(\"token\", response.data.data.token);\n            localStorage.setItem(\"sid\", response.data.data.sid);\n            ElMessage({\n              message: '欢迎回来',\n              type: 'success'\n            });\n            this.$router.push('/home');\n          }).catch(error => {\n            console.log(error);\n          });\n        }\n      });\n      this.getCaptcha();\n    },\n    // 获取验证码\n    getCaptcha() {\n      this.$axios.get('/captcha').then(response => {\n        this.loginForm.captchaId = response.data.data.captchaId;\n        this.captchaImg = response.data.data.captchaImg;\n        this.loginForm.captchaValue = '';\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"AAoDA,SAASA,SAAQ,QAAS,cAAa;AACvC,SAASC,IAAI,EAAEC,IAAI,EAAEC,WAAU,QAAS,yBAAwB;AAChE,eAAe;EACbC,IAAI,EAAE,OAAO;EACbC,KAAK,GAAG;IACN,OAAO;MAACJ,IAAI;MAAEC,IAAI;MAAEC;IAAW;EACjC,CAAC;EACDG,IAAI,GAAG;IACL,OAAO;MACLC,IAAI,EAAE,IAAI;MACVC,SAAS,EAAE;QACTC,QAAQ,EAAE,OAAO;QACjBC,QAAQ,EAAE,OAAO;QACjBC,SAAS,EAAE,EAAE;QACbC,YAAY,EAAE;MAChB,CAAC;MACDC,UAAU,EAAE,IAAI;MAChBC,KAAK,EAAE;QACLL,QAAQ,EAAE,CACR;UAACM,OAAO,EAAE,IAAI;UAAEC,OAAO,EAAE,OAAO;UAAEC,OAAO,EAAE;QAAM,EAClD;QACDP,QAAQ,EAAE,CACR;UAACK,OAAO,EAAE,IAAI;UAAEC,OAAO,EAAE,OAAO;UAAEC,OAAO,EAAE;QAAM,EAClD;QACDL,YAAY,EAAE,CACZ;UAACM,QAAQ,EAAE,IAAI;UAAEF,OAAO,EAAE,QAAQ;UAAEC,OAAO,EAAE;QAAM,CAAC,EACpD;UAACE,GAAG,EAAE,CAAC;UAAEC,GAAG,EAAE,CAAC;UAAEJ,OAAO,EAAE,WAAW;UAAEC,OAAO,EAAE;QAAM;MAE1D;IACF,CAAC;EACH,CAAC;EACDI,OAAO,GAAG;IACR,IAAI,CAACC,UAAU,EAAE;EACnB,CAAC;EACDC,OAAO,GAAG;IACR,IAAI,CAACD,UAAU,EAAE;EACnB,CAAC;EACDE,OAAO,EAAE;IAEP;IACAC,UAAU,CAACC,QAAQ,EAAE;MACnB,IAAI,CAACC,KAAK,CAACD,QAAQ,CAAC,CAACE,QAAQ,CAAEC,KAAK,IAAK;QACvC,IAAIA,KAAK,EAAE;UACT,IAAI,CAACC,MAAM,CAACC,IAAI,CAAC,QAAQ,EAAE;YACzBtB,QAAQ,EAAE,IAAI,CAACD,SAAS,CAACC,QAAQ;YACjCC,QAAQ,EAAE,IAAI,CAACF,SAAS,CAACE,QAAQ;YACjCC,SAAS,EAAE,IAAI,CAACH,SAAS,CAACG,SAAS;YACnCC,YAAY,EAAE,IAAI,CAACJ,SAAS,CAACI;UAC/B,CAAC,CAAC,CAACoB,IAAI,CAAEC,QAAQ,IAAK;YACpBC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,QAAQ,CAAC3B,IAAI,CAACA,IAAI,CAAC8B,KAAK;YACtDF,YAAY,CAACC,OAAO,CAAC,KAAK,EAAEF,QAAQ,CAAC3B,IAAI,CAACA,IAAI,CAAC+B,GAAG;YAClDrC,SAAS,CAAC;cAAEgB,OAAO,EAAE,MAAM;cAAEsB,IAAI,EAAE;YAAS,CAAC;YAC7C,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,OAAO,CAAC;UAC5B,CAAC,CAAC,CAACC,KAAK,CAAEC,KAAK,IAAK;YAClBC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;UACpB,CAAC;QACH;MACF,CAAC,CAAC;MACF,IAAI,CAACpB,UAAU,EAAE;IACnB,CAAC;IAED;IACAA,UAAU,GAAG;MACX,IAAI,CAACQ,MAAM,CAACe,GAAG,CAAC,UAAU,CAAC,CAACb,IAAI,CAACC,QAAO,IAAK;QAC3C,IAAI,CAACzB,SAAS,CAACG,SAAQ,GAAIsB,QAAQ,CAAC3B,IAAI,CAACA,IAAI,CAACK,SAAQ;QACtD,IAAI,CAACE,UAAS,GAAIoB,QAAQ,CAAC3B,IAAI,CAACA,IAAI,CAACO,UAAS;QAC9C,IAAI,CAACL,SAAS,CAACI,YAAW,GAAI,EAAC;MACjC,CAAC;IACH;EACF;AACF","names":["ElMessage","User","Lock","CircleCheck","name","setup","data","show","loginForm","username","password","captchaId","captchaValue","captchaImg","rules","equired","message","trigger","required","min","max","mounted","getCaptcha","updated","methods","submitForm","formName","$refs","validate","valid","$axios","post","then","response","localStorage","setItem","token","sid","type","$router","push","catch","error","console","log","get"],"sourceRoot":"","sources":["/Users/work/server/imall/web/src/view/Login.vue"],"sourcesContent":["<template>\n  <div class=\"main\">\n    <div class=\"form\">\n      <img src=\"../assets/logo.png\" class=\"logo\" alt=\"logo\"/>\n      <el-form :model=\"loginForm\"\n               :rules=\"rules\"\n               ref=\"loginForm\">\n        <el-form-item prop=\"username\">\n          <el-input type=\"text\"\n                    v-model=\"loginForm.username\"\n                    autocomplete=\"off\"\n                    size=\"large\"\n                    :prefix-icon=\"User\"/>\n        </el-form-item>\n        <el-form-item prop=\"password\">\n          <el-input type=\"password\"\n                    v-model=\"loginForm.password\"\n                    autocomplete=\"off\"\n                    size=\"large\"\n                    :prefix-icon=\"Lock\"/>\n        </el-form-item>\n        <el-form-item prop=\"captchaValue\">\n          <div style=\"display: inline-flex;\">\n            <el-input v-model=\"loginForm.captchaValue\"\n                      :prefix-icon=\"CircleCheck\"\n                      size=\"large\"\n                      style=\"width: 50%;\"\n                      maxlength=\"5\"/>\n            <el-image :src=\"captchaImg\" class=\"captchaImg\" @click=\"getCaptcha\"/>\n          </div>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\"\n                     class=\"button\"\n                     size=\"large\"\n                     @click=\"submitForm('loginForm')\">登 录</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <div class=\"footer\">\n      <div>MIT License Copyright (c) 2022 zchengo</div>\n      <div><el-divider direction=\"vertical\" /></div>\n      <a href=\"https://github.com/zchengo/imall\">Github</a>\n      <div><el-divider direction=\"vertical\" /></div>\n      <a href=\"https://www.zhihu.com/people/87-4-8-5\">Zhihu</a>\n      <div><el-divider direction=\"vertical\" /></div>\n      <a href=\"#\">About</a>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ElMessage } from 'element-plus'\nimport { User, Lock, CircleCheck } from '@element-plus/icons-vue'\nexport default {\n  name: \"Login\",\n  setup() {\n    return {User, Lock, CircleCheck}\n  },\n  data() {\n    return {\n      show: true,\n      loginForm: {\n        username: 'admin',\n        password: '12345',\n        captchaId: '',\n        captchaValue: '',\n      },\n      captchaImg: null,\n      rules: {\n        username: [\n          {equired: true, message: '请输入账号', trigger: 'blur'}\n        ],\n        password: [\n          {equired: true, message: '请输入密码', trigger: 'blur'}\n        ],\n        captchaValue: [\n          {required: true, message: '请输入验证码', trigger: 'blur'},\n          {min: 4, max: 4, message: '长度为 4 个字符', trigger: 'blur'}\n        ],\n      }\n    };\n  },\n  mounted() {\n    this.getCaptcha();\n  },\n  updated() {\n    this.getCaptcha();\n  },\n  methods: {\n\n    // 用户登录\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.$axios.post('/login', {\n            username: this.loginForm.username,\n            password: this.loginForm.password,\n            captchaId: this.loginForm.captchaId,\n            captchaValue: this.loginForm.captchaValue,\n          }).then((response) => {\n            localStorage.setItem(\"token\", response.data.data.token)\n            localStorage.setItem(\"sid\", response.data.data.sid)\n            ElMessage({ message: '欢迎回来', type: 'success'})\n            this.$router.push('/home');\n          }).catch((error) => {\n            console.log(error);\n          })\n        }\n      });\n      this.getCaptcha();\n    },\n\n    // 获取验证码\n    getCaptcha() {\n      this.$axios.get('/captcha').then(response => {\n        this.loginForm.captchaId = response.data.data.captchaId\n        this.captchaImg = response.data.data.captchaImg\n        this.loginForm.captchaValue = ''\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.main {\n  width: 100%;\n  height: 100vh;\n  display: flex;\n  background-image: url(\"../assets/back.png\");\n  background-size: 100% 60%;\n  background-repeat: no-repeat;\n  /* background-color: #e8ecf1; */\n  background-color: #F5F7FA;\n}\n.form {\n  width: 25%;\n  height: 50%;\n  margin: 150px auto;\n  text-align: center;\n  padding: 20px;\n  background-color: white;\n  border-radius: 15px;\n  box-shadow: 0px 0px 1px #F2F6FC;\n}\n.logo {\n  width: 80px;\n  height: 80px;\n  margin: 20px;\n  border-radius: 15px;\n  box-shadow: 0px 0px 12px #ebeff4;\n}\n.captchaImg {\n  width: 45%;\n  height: 40px;\n  margin-left: 5%;\n  float: left;\n  border-radius: 5px;\n  background-color: #ecf5ff;\n}\n.button {\n  width: 100%;\n  margin-top: 5px;\n}\n\n.footer{\n  bottom: 0;\n  width: 100%;\n  height: 80px;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #606266;\n  font-size: 10px;\n}\n\n.footer a{\n  color: #606266;\n}\n.footer a:hover{\n  color: #2d2d2f;\n  transition: 0.5s;\n}\n</style>"]},"metadata":{},"sourceType":"module"}